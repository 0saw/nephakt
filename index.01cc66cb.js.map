{"mappings":"imBAsBA,IAAAA,EACAC,E,iJArBA,IAAIC,EAAU,CAAC,EAoBfF,EAlBA,SAAkBG,GAGhB,IAFA,IAAIC,EAAOC,OAAOD,KAAKD,GAEdG,EAAI,EAAGA,EAAIF,EAAKG,OAAQD,IAC/BJ,EAAQE,EAAKE,IAAMH,EAAMC,EAAKE,GAElC,EAaAL,EAXA,SAAiBO,GACf,IAAIC,EAAWP,EAAQM,GAEvB,GAAgB,MAAZC,EACF,MAAM,IAAIC,MAAM,oCAAsCF,GAGxD,OAAOC,CACT,C,ICpBAE,EAAA,SAAAC,SAA8CC,KAAKC,MAAM,iJCAlD,MAAMC,EAA0DC,IACrE,MAAMC,EAAyC,GAEzCC,EAAaC,IACjBF,EAAYG,KAAKD,EAAA,EAGbE,EAAO,KACXJ,EAAYK,SAASH,IACnBA,EAAWH,EAAA,GACb,EAGIO,EAAWC,IACR,CACLC,IAAK,SAAUC,EAAKC,GAClB,MAAa,aAATA,IAIS,cAATA,EACKT,GAGL,CAAC,SAAU,SAASU,SAASvB,OAAOwB,UAAUC,SAASC,KAAKL,EAAIC,IAAOK,MAAM,GAAG,GAAIC,iBAAyC,IAAvBP,EAAIC,GAAMO,UAClHC,QAAQC,IAAIV,EAAKC,EAAM,IAAIU,MAAMX,EAAIC,GAAOJ,EAAQC,KAG/CE,EAAIC,IACb,EAEAS,IAAK,SAAUV,EAAKC,EAAMW,GACxB,OAAIZ,EAAIC,KAAUW,IAIlBH,QAAQC,IAAIV,EAAKC,EAAMW,GACvBjB,MAJS,CAOX,EAEAkB,eAAgB,SAAUb,EAAKC,GAI7B,OAHAQ,QAAQI,eAAeb,EAAKC,GAC5BN,KAEO,CACT,IAIJ,OAAO,IAAIgB,MAAMrB,EAAMO,EAAQP,GAAA,ECjD3BwB,EAAc,sCAEPC,EAAc,KACzB,MAAMC,EAAQC,OAAOC,SAASC,KAAKH,MAAMF,GAEzC,GAAc,OAAVE,QAA0C,IAAjBA,EAAMI,OACjC,MAAO,CACLC,KAAM,GACNC,OAAQ,GACRC,aAAc,IAAIC,gBAAgB,KAItC,IACE,MAAMD,EAAe,IAAIC,gBAAgBR,EAAMI,OAAOE,QAEtD,MAAO,CACLD,KAAML,EAAMI,OAAOC,MAAQ,GAC3BC,OAAQC,EAAanB,W,aACrBmB,EAQJ,CANE,MAAOE,GACP,MAAO,CACLJ,KAAML,EAAMI,OAAOC,MAAQ,GAC3BC,OAAQ,GACRC,aAAc,IAAIC,gBAAgB,IAEtC,GC1BWE,EAAeC,IAC1B,MAAMC,EAAkBb,IACxB,IAAIM,KACFA,EAAOO,EAAgBP,KAAIE,aAC3BA,EAAeK,EAAgBL,cAC7BI,OAEwB,IAAjBA,EAAML,SACfC,EAAe,IAAIC,gBAAgBG,EAAML,SAGX,KAA5BC,EAAanB,WACfa,OAAOC,SAASC,KAAOE,EAEvBJ,OAAOC,SAASC,KAAO,GAAGE,KAAQE,EAAanB,YAAY,ECLlDyB,EAAQxC,EAAoB,CACvCyC,MAAO,KAGIC,EAAYF,EAAMrC,UAgBlBwC,EAAoB,KAC/BH,EAAMC,MAAQG,GAAA,EAGVC,EAAc,kBAEdD,EAAiB,KACrB,IACE,MAAME,EAAclB,OAAOmB,aAAaC,QAAQH,GAChD,GAAoB,OAAhBC,EACF,MAAO,GAGT,MAAMG,EAAWnD,KAAKC,MAAM+C,GAC5B,GACEI,MAAMC,QAAQF,IACdA,EAASzD,OAAS,GAClB,UAAWyD,EAAS,IACpB,OAAQA,EAAS,IACjB,kBAAmBA,EAAS,GAE5B,OAAOA,CAIX,CAFE,MAAOb,GAET,CAEA,MAAO,EAAE,EAGLgB,EAAiBX,IACrBb,OAAOmB,aAAaM,QAAQR,EAAa/C,KAAKwD,UAAUb,EAAMxB,MAAM,EAAG,QC/DlE,MAAMsC,EAAa,IAAI5D,MAAM,kCAEvB6D,EAAcC,MAAgBC,IACzC,MAAMC,EAAY,IAAIC,IAAI,+BAA0BF,KAIpD,OAHAC,EAAUzB,aAAab,IAAI,8CAC3BsC,EAAUzB,aAAab,IAAI,WAAY,eAE1BwC,MAAMF,GAChBG,MAAMC,IACL,GAAIA,EAASC,GACX,OAAOD,EAGT,MAAMR,CAAA,IAEPO,MAAKL,MAAOM,SAAmBA,EAASE,QAAI,ECPpCC,ECWGC,SACdC,EACAC,EACAC,WAOIC,WARJF,MAAmB,aACnBC,MAAkC,IAQlC,IAAME,WAAcF,EAAQE,gBACtBC,WAAWH,EAAQG,aACnBC,EAAUJ,EAAQI,QACpBC,EAAiBC,KAAKC,MAEtBC,EAA8C,GAElD,SAASC,IACP,YAAIL,EAAuB,CACzB,IAAMM,EAA0BJ,KAAKC,MAAQF,EAE7C,GAAIK,EAA0BX,GAAoBK,EAChD,OAAOA,EAAUM,EAIrB,OAAOX,EAGT,IAAMY,EAAoB,eAErBC,2BAEGC,EAAUC,KAChB,WAAWC,SAAuB,SAACC,EAASC,GAC1C,IAWMC,EAAgBhB,YAAeD,EAQrC,YANIA,GACFkB,aAAalB,GAGfA,EAAYmB,YAjBW,WAGrB,GAFAnB,SACAI,EAAiBC,KAAKC,OACjBL,EAAa,CAChB,IAAMmB,EAASvB,EAAKwB,MAAMT,EAASD,GACnCT,GAAYA,EAASkB,GACrBb,EAASvE,SAAQ,SAAAsF,GAAA,SAAiBP,EAAdA,SAAsBK,MAC1Cb,EAAW,MAUwBC,KAEnCS,EAAe,CACjB,IAAMG,EAASvB,EAAKwB,MAAMT,EAASD,GAEnC,OADAT,GAAYA,EAASkB,GACdL,EAAQK,GAEjBb,EAASzE,KAAK,CAAEiF,UAASC,eAY7B,OARAN,EAAkBa,OAAS,SAAUC,YAC/BxB,GACFkB,aAAalB,GAEfO,EAASvE,SAAQ,SAAA6B,GAAA,SAAgBmD,EAAbA,QAAoBQ,MACxCjB,EAAW,IAGNG,CAxEOd,CDXuB,EAJTV,MAAOuC,SACtBxC,EAAY,uBAAuBwC,MAGc,KAEnDC,EAAWxC,MAAOhE,SAChB+D,EAAY,UAAU/D,KEUxByG,EAAQlG,EAAwB,CAC3CmG,kBAAkB,EAClBC,WAAY1E,IAAcQ,aAAaxB,IAAI,MAAQ,GACnD2F,eAAgB,GAChBC,YAAa,KAGFC,EAAYL,EAAM/F,UAElBqG,EAAmB/C,UAC9B,GAAIyC,EAAMG,iBAAmBH,EAAME,WAOnC,GAHAF,EAAMG,eAAiBH,EAAME,WAC7BlC,EAAwB4B,OAAO,SAEC,KAA5BI,EAAME,WAAWK,OAKrB,IACE,MAAMC,QAAEA,SAAkBxC,EAAwBgC,EAAME,YACxDF,EAAMI,YAAcI,CAKtB,CAJE,MAAOtE,GACP,GAAU,UAANA,EACF,MAAMA,CAEV,MAXE8D,EAAMI,YAAc,EAWtB,EAGIK,EAAsBC,GAC1BA,EAAI1F,cAAc2F,WAAW,cAAe,IAGjCC,EAAoB,KAC/B,MAAMC,EAAqBJ,EAAmBT,EAAME,YAC9CY,EAA6BxE,EAAmBC,MACnDwE,QAAQC,GACPP,EAAmBO,EAAKC,OAAOtG,SAASkG,IACxCJ,EAAmBO,EAAKE,eAAevG,SAASkG,KAEjD9F,MAAM,EAAG,GACToG,KAAKH,IAAU,CACdI,KAAM,UACNH,MAAO,GAAGD,EAAKC,QAA+B,KAAvBD,EAAKE,cAAuB,KAAKF,EAAKE,iBAAmB,KAChF7F,MAAO2F,EAAKzH,GACZ8H,SAAUL,EAAKC,MACfC,cAAeF,EAAKE,kBAGlBI,EAAaR,EAAiBK,KAAKH,GAASA,EAAK3F,QAEjDkG,EAAiCvB,EAAMI,YAC1CW,QAAQS,IAAgBF,EAAW3G,SAAS6G,EAAWjI,MACvDwB,MAAM,EAAG,GAAK+F,EAAiBxH,QAC/B6H,KAAKK,IACJ,MAAMC,EAA4B,GAUlC,MARkC,KAA9BD,EAAWE,gBAAyBF,EAAWE,iBAAmBF,EAAWP,OAC/EQ,EAAgBtH,KAAKqH,EAAWE,gBAGF,KAA5BF,EAAWG,mBAAwE,IAA1CH,EAAWG,aAAaC,MAAM,KAAK,IAC9EH,EAAgBtH,KAAKqH,EAAWG,aAAaC,MAAM,KAAK,IAGlD,CACNR,KAAM,SACNH,MAAO,GAAGO,EAAWP,QAAQQ,EAAgBnI,OAAS,EAAI,KAAKmI,EAAgBI,KAAK,SAAW,KAC/FxG,MAAOmG,EAAWjI,GAClB8H,SAAUG,EAAWP,MACrBC,cAAeM,EAAWE,eAC5B,IAGJ,MAAO,IAAIZ,KAAqBS,EAAqB,EC9E1CO,EAAQhI,EAAmB,CACtCkH,KAAM,OAGKe,EAAYD,EAAM7H,UAElB+H,EAAYzE,MAAOhE,IAC9B,IACE,MAAM0I,QAAsBlC,EAASxG,GAErC,GAAI,YAAa0I,IAAkBA,EAAcC,QAG/C,YAFAJ,EAAMd,KAAO,MAKf,KAAM,OAAQiB,GACZ,OAGFH,EAAMd,KAAO,CACXmB,OAAQF,EAAcE,OACtB5I,GAAI0I,EAAc1I,GAClB6I,OAAQH,EAAcI,QACtBC,QAASL,EAAcK,QACvBpB,cAAee,EAAcP,eAC7Ba,SAAUN,EAAcM,SACxBtB,MAAOgB,EAAchB,MACrBuB,WAAYP,EAAcQ,YAC1BC,KAAMT,EAAcN,aAAaC,MAAM,KAAK,GAKhD,CAHE,MAAOe,GACPb,EAAMd,KAAO,KACb4B,QAAQD,MAAM,sCAChB,GAGWE,EAAY,KACvBf,EAAMd,KAAO,IAAI,E,MC1DnB8B,EAAiB,IAAApF,IAAoBhE,EAAA,SAAA0F,QAA6C,SAAA2D,OAAAC,KAAAxF,KAAU3C,WCG5F,MAAMoI,EAAA,IAAAvF,IAAAoF,G,MCHNI,EAAiB,IAAAxF,IAAoBhE,EAAA,SAAA0F,QAA6C,SAAA2D,OAAAC,KAAAxF,KAAU3C,WDI5F,MAAMsI,EAAA,IAAAzF,IAAAwF,GEAc,MAClB,MAAME,EAAiBC,SAASC,cAA8B,eACxDC,EAAcF,SAASC,cAAgC,oBAE7D,GAAuB,OAAnBF,GAA2C,OAAhBG,EAC7B,OAGF,MAAMC,EAAS,KACb,MAAMzH,OAAEA,GAAWP,IAEnB4H,EAAeK,MAAMC,QAA8C,IAApCpH,EAAmBC,MAAMjD,OAAe,OAAS,GAEhFiK,EAAYI,UAAYrH,EAAmBC,MACxCxB,MAAM,EAAG,GACToG,KAAI,EAACF,MAAEA,EAAK1H,GAAEA,KAAU,0KAIHA,IAAgB,KAAXwC,EAAgB,IAAIA,IAAW,mBACnDkF,iCAGNY,KAAK,KAGVnG,OAAOkI,iBAAiB,UAAWnH,GAEnCA,IACA4D,EAA2BmD,GAC3BhH,EAAuBgH,GACvBA,GAAA,EC/BFK,GCAoB,MAClB,MAAMC,EAAcT,SAASC,cAA+B,oBACtDS,EAAeV,SAASC,cAAiC,qBACzDU,EAAeX,SAASC,cAAgC,qBACxDW,EAAqBZ,SAASC,cAAgC,uBAEpE,GAAoB,OAAhBQ,GAAyC,OAAjBC,GAA0C,OAAjBC,GAAgD,OAAvBC,EAC5E,OAGF,MAAMT,EAAS,KACb,MAAMvD,iBACJA,EAAgBC,WAChBA,EAAUE,YACVA,GACEJ,GAEEjE,OAAEA,GAAWP,IAEnBwI,EAAa3I,MAAQ6E,EAErB+D,EAAmBR,MAAMC,QAAUzD,GAA2C,IAAvBG,EAAY9G,OAAe,GAAK,OACvF2K,EAAmBN,UAAY/C,IAC5BO,KAAKK,GAAgB,kHAG0E,YAApBA,EAAWJ,KAAqB,mBAAqB,kCAC3GI,EAAWnG,QAAmB,KAAXU,EAAgB,IAAIA,IAAW,mBACjEyF,EAAWP,qCAGjBY,KAAK,KAGViC,EAAYF,iBAAiB,UAAW1H,IACtCA,EAAEgI,gBAAc,IAGlBH,EAAaH,iBAAiB,SAAS,KACrC5D,EAAuBE,WAAa,GACpCF,EAAuBI,YAAc,GACrCJ,EAAuBC,kBAAmB,EAC1C9D,EAAY,CAAEJ,OAAQ,IAAG,IAG3BiI,EAAaJ,iBAAiB,SAASrG,OAAO4G,cAAEA,MACxCA,aAAyBC,mBAI/BpE,EAAuBE,WAAaiE,EAAc9I,MAClDc,EAAY,CACVJ,OAAuC,KAA/BoI,EAAc9I,MAAMkF,OAAgB,KAAK4D,EAAc9I,QAAU,WAGrEiF,IAAA,IAGR0D,EAAaJ,iBAAiB,QAAStD,GAEvCwD,EAAYF,iBAAiB,WAAY1H,IACvC,MAAMmI,EAAQrH,MAAMpC,UAAU0J,QAAQxJ,KAAKmJ,EAAmBM,SAAUlB,SAASmB,eAAeC,QAAQ,OACxG,IAAIC,EAAWL,EAED,YAAVnI,EAAEyI,IACJD,EAAWE,KAAKC,IAAI,EAAGH,EAAW,GACf,cAAVxI,EAAEyI,IACXD,EAAWE,KAAKE,IAAIb,EAAmBM,SAASjL,OAAS,EAAGoL,EAAW,GACpD,WAAVxI,EAAEyI,MACX3E,EAAuBC,kBAAmB,GAGxCoE,IAAUK,GAAY,CAAC,UAAW,aAAa/J,SAASuB,EAAEyI,MAC5DV,EAAmBM,SAASG,IAAWpB,cAAc,MAAMyB,OAAA,IAI/Df,EAAaJ,iBAAiB,SAAS,KACrC5D,EAAuBC,kBAAmB,CAAI,IAGhDoD,SAASO,iBAAiB,SAAU1H,IAClC,IAAK8D,EAAuBC,iBAC1B,OAGF,MAAM+E,EAAW9I,EAAE+I,kBAAkBC,MAAQpB,EAAYqB,SAASjJ,EAAE+I,QAChEjF,EAAuBC,mBAAqB+E,IAC9C9I,EAAEgI,iBACFhI,EAAEkJ,kBACFlJ,EAAEmJ,2BAEFrF,EAAuBC,iBAAmB+E,EAC5C,IAGFf,EAAmBL,iBAAiB,SAAU1H,IAC5C,KAAMA,EAAE+I,kBAAkBK,SACxB,OAGF,MAAMC,EAAYrJ,EAAE+I,OAAOR,QAAQ,MACnC,GAAkB,OAAdc,EACF,OAGF,MAAMC,EAAexI,MAAMpC,UAAU0J,QAAQxJ,KAAKmJ,EAAmBM,SAAUgB,GACzEnH,EAAUwC,IAEhB,QAAqC,IAA1BxC,EAAQoH,GAA+B,CAChD,MAAMnE,SAAEA,EAAQhG,MAAEA,EAAK6F,cAAEA,GAAkB9C,EAAQoH,GXhGnC,CAACxE,IACrB,MAAMjE,EAAW,IAAIT,EAAMC,OACrBkJ,EAAiB1I,EAAS2I,WAAWC,GAAeA,EAAWpM,KAAOyH,EAAKzH,MAE1D,IAAnBkM,GACF1I,EAAS6I,OAAOH,EAAgB,GAGlC1I,EAAS8I,QAAQ7E,GAEjB1E,EAAMC,MAAQQ,EACdG,EAAcH,EAAA,EWuFV+I,CAAoB,CAClB7E,MAAOI,EACP9H,GAAI8B,E,cACJ6F,GAEJ,CAEAlB,EAAuBC,kBAAmB,CAAK,IAGjDzD,EAAuBgH,GACvBnD,EAA2BmD,GAC3BA,GAAA,ED3HFuC,GHCoB,MAClB,MAAMC,EAAgB3C,SAASC,cAA8B,cAC7D,GAAsB,OAAlB0C,EACF,OAGF,MAAMxC,EAAS,KACb,MAAMxC,KACJA,GACEc,EAEJ,GAAa,OAATd,EAGF,YAFAgF,EAAcrC,UAAY,IAK5B,MAAMxB,OACJA,EAAMC,OACNA,EAAMnB,MACNA,EAAKsB,SACLA,EAAQD,QACRA,EAAOE,WACPA,EAAUE,KACVA,GACE1B,EAEJgF,EAAcrC,UAAY,WACP,KAAfnB,EACG,mFACqEA,qIAEZA,2CAC/BvB,2CACAkC,EAAWtI,yDAItC,+EAIiBoG,IAAiB,KAATyB,EAAc,KAAKA,KAAU,4BAE1C,KAAZJ,EAAiB,4BAA4BA,iBAAyB,uBAEzD,KAAbC,EAAkB,MAAMA,QAAiB,uBAEzCJ,EAAO7I,OAAS,EACb,8FAGG6I,EAAOhB,KAAI,EAAC8E,KAAEA,KAAY,oFACuCA,4BAC/DpE,KAAK,sCAGX,yBAGS,KAAXO,EACG,sHAEuCA,2EACxBa,EAAQpI,0EAIxB,wBAGP,EAGGqL,EAAwB3I,UAC5B,MAAMzB,KAAEA,GAASN,IAEXC,EAAQK,EAAKL,MAAM,mBACzB,GAAc,OAAVA,GAAkBA,EAAMnC,QAAU,EAGpC,YAFAuJ,IAKF,MAAMsD,EAAUC,SAAS3K,EAAM,GAAI,IAC/B4K,OAAOC,MAAMH,GACftD,UAKIb,EAAsBmE,EAAA,EAG9BzK,OAAOkI,iBAAiB,aAAcsC,GAEjCA,IACLnE,EAAsByB,GACtBA,GAAA,EGlGF+C","sources":["node_modules/@parcel/runtime-js/lib/helpers/bundle-manifest.js","node_modules/@parcel/runtime-js/lib/runtime-ae97b2b000e57ce7.js","src/store/store.ts","src/utils/getURLParts.ts","src/utils/setURLParts.ts","src/store/history.ts","src/request/index.ts","src/api/index.ts","node_modules/ts-debounce/src/index.ts","src/store/suggestions.ts","src/store/detail.ts","node_modules/@parcel/runtime-js/lib/runtime-5d3ee5fe164335a5.js","src/blocks/detail/index.ts","node_modules/@parcel/runtime-js/lib/runtime-4552b7bd7e348715.js","src/blocks/history/index.ts","src/index.ts","src/blocks/suggestions/index.ts"],"sourcesContent":["\"use strict\";\n\nvar mapping = {};\n\nfunction register(pairs) {\n  var keys = Object.keys(pairs);\n\n  for (var i = 0; i < keys.length; i++) {\n    mapping[keys[i]] = pairs[keys[i]];\n  }\n}\n\nfunction resolve(id) {\n  var resolved = mapping[id];\n\n  if (resolved == null) {\n    throw new Error('Could not resolve bundle with id ' + id);\n  }\n\n  return resolved;\n}\n\nmodule.exports.register = register;\nmodule.exports.resolve = resolve;","require('./helpers/bundle-manifest').register(JSON.parse(\"{\\\"jFg1u\\\":\\\"index.01cc66cb.js\\\",\\\"hEwHo\\\":\\\"imdb.7bd187a1.svg\\\",\\\"gGD6r\\\":\\\"no-image.9af9ecce.svg\\\"}\"));","export const store = <T extends Record<string | symbol | number, any>>(data: T): T & { _isProxy: boolean, subscribe: (arg0: (state: T) => void) => void } => {\n  const subscribers: Array<(state: T) => void> = []\n\n  const subscribe = (subscriber: typeof subscribers[0]): void => {\n    subscribers.push(subscriber)\n  }\n\n  const emit = (): void => {\n    subscribers.forEach((subscriber): void => {\n      subscriber(data)\n    })\n  }\n\n  const handler = (dataObj: T): ProxyHandler<T> => {\n    return {\n      get: function (obj, prop) {\n        if (prop === '_isProxy') {\n          return true\n        }\n\n        if (prop === 'subscribe') {\n          return subscribe\n        }\n\n        if (['object', 'array'].includes(Object.prototype.toString.call(obj[prop]).slice(8, -1).toLowerCase()) && obj[prop]._isProxy === false) {\n          Reflect.set(obj, prop, new Proxy(obj[prop], handler(dataObj)))\n        }\n\n        return obj[prop]\n      },\n\n      set: function (obj, prop, value) {\n        if (obj[prop] === value) {\n          return true\n        }\n\n        Reflect.set(obj, prop, value)\n        emit()\n\n        return true\n      },\n\n      deleteProperty: function (obj, prop) {\n        Reflect.deleteProperty(obj, prop)\n        emit()\n\n        return true\n      }\n    }\n  }\n\n  return new Proxy(data, handler(data)) as T & { _isProxy: boolean, subscribe: (arg0: (state: T) => void) => void }\n}\n","import type { URLParts } from '../types'\n\nconst PATH_REGEXP = /^#(?<path>[^?]+)?\\??(?<search>.*)?$/\n\nexport const getURLParts = (): URLParts => {\n  const match = window.location.hash.match(PATH_REGEXP)\n\n  if (match === null || typeof match.groups === 'undefined') {\n    return {\n      path: '',\n      search: '',\n      searchParams: new URLSearchParams('')\n    }\n  }\n\n  try {\n    const searchParams = new URLSearchParams(match.groups.search)\n\n    return {\n      path: match.groups.path ?? '',\n      search: searchParams.toString(),\n      searchParams\n    }\n  } catch (e) {\n    return {\n      path: match.groups.path ?? '',\n      search: '',\n      searchParams: new URLSearchParams('')\n    }\n  }\n}\n","import type { URLParts } from '../types'\nimport { getURLParts } from './getURLParts'\n\nexport const setURLParts = (parts: Partial<URLParts>): void => {\n  const currentURLParts = getURLParts()\n  let {\n    path = currentURLParts.path,\n    searchParams = currentURLParts.searchParams\n  } = parts\n\n  if (typeof parts.search !== 'undefined') {\n    searchParams = new URLSearchParams(parts.search)\n  }\n\n  if (searchParams.toString() === '') {\n    window.location.hash = path\n  } else {\n    window.location.hash = `${path}?${searchParams.toString()}`\n  }\n}\n","import { store } from './store'\n\nexport interface HistoryItem {\n  title: string\n  id: number\n  originalTitle: string\n}\n\nexport interface HistoryState {\n  items: HistoryItem[]\n}\n\nexport const state = store<HistoryState>({\n  items: []\n})\n\nexport const subscribe = state.subscribe\n\nexport const append = (item: HistoryItem): void => {\n  const newItems = [...state.items]\n  const indexOfSimilar = newItems.findIndex((lookupItem) => lookupItem.id === item.id)\n\n  if (indexOfSimilar !== -1) {\n    newItems.splice(indexOfSimilar, 1)\n  }\n\n  newItems.unshift(item)\n\n  state.items = newItems\n  updateStorage(newItems)\n}\n\nexport const updateFromStorage = (): void => {\n  state.items = getFromStorage()\n}\n\nconst STORAGE_KEY = 'nephakt-history'\n\nconst getFromStorage = (): HistoryItem[] => {\n  try {\n    const newItemsRaw = window.localStorage.getItem(STORAGE_KEY)\n    if (newItemsRaw === null) {\n      return []\n    }\n\n    const newItems = JSON.parse(newItemsRaw)\n    if (\n      Array.isArray(newItems) &&\n      newItems.length > 0 &&\n      'title' in newItems[0] &&\n      'id' in newItems[0] &&\n      'originalTitle' in newItems[0]\n    ) {\n      return newItems\n    }\n  } catch (e) {\n    // no-op\n  }\n\n  return []\n}\n\nconst updateStorage = (items: HistoryItem[]): void => {\n  window.localStorage.setItem(STORAGE_KEY, JSON.stringify(items.slice(0, 100)))\n}\n","export const ErrRequest = new Error('ошибка при обращении к серверу')\n\nexport const makeRequest = async <T = any>(url: string): Promise<T> => {\n  const urlObject = new URL(`${process.env.API_BASE}${url}`)\n  urlObject.searchParams.set('api_key', process.env.API_KEY)\n  urlObject.searchParams.set('language', 'ru-RU')\n\n  return await fetch(urlObject)\n    .then((response) => {\n      if (response.ok) {\n        return response\n      }\n\n      throw ErrRequest\n    })\n    .then(async (response) => await response.json())\n}\n","import type { MovieResponse, SearchResponse } from '../types'\nimport { debounce } from 'ts-debounce'\nimport { makeRequest } from '../request'\n\nexport const getSuggestions = async (query: string): Promise<SearchResponse> => {\n  return await makeRequest(`/search/movie?query=${query}`)\n}\n\nexport const getSuggestionsDebounced = debounce(getSuggestions, 300)\n\nexport const getMovie = async (id: number): Promise<MovieResponse | { success: false }> => {\n  return await makeRequest(`/movie/${id}`)\n}\n","export type Options<Result> = {\n  isImmediate?: boolean;\n  maxWait?: number;\n  callback?: (data: Result) => void;\n};\n\nexport interface DebouncedFunction<\n  Args extends any[],\n  F extends (...args: Args) => any\n> {\n  (this: ThisParameterType<F>, ...args: Args): Promise<ReturnType<F>>;\n  cancel: (reason?: any) => void;\n}\n\ninterface DebouncedPromise<FunctionReturn> {\n  resolve: (result: FunctionReturn) => void;\n  reject: (reason?: any) => void;\n}\n\nexport function debounce<Args extends any[], F extends (...args: Args) => any>(\n  func: F,\n  waitMilliseconds = 50,\n  options: Options<ReturnType<F>> = {}\n): {\n  (this: ThisParameterType<F>, ...args: Parameters<F> & Args): Promise<\n    ReturnType<F>\n  >;\n  cancel: (reason?: any) => void;\n} {\n  let timeoutId: ReturnType<typeof setTimeout> | undefined;\n  const isImmediate = options.isImmediate ?? false;\n  const callback = options.callback ?? false;\n  const maxWait = options.maxWait;\n  let lastInvokeTime = Date.now();\n\n  let promises: DebouncedPromise<ReturnType<F>>[] = [];\n\n  function nextInvokeTimeout() {\n    if (maxWait !== undefined) {\n      const timeSinceLastInvocation = Date.now() - lastInvokeTime;\n\n      if (timeSinceLastInvocation + waitMilliseconds >= maxWait) {\n        return maxWait - timeSinceLastInvocation;\n      }\n    }\n\n    return waitMilliseconds;\n  }\n\n  const debouncedFunction = function (\n    this: ThisParameterType<F>,\n    ...args: Parameters<F>\n  ) {\n    const context = this;\n    return new Promise<ReturnType<F>>((resolve, reject) => {\n      const invokeFunction = function () {\n        timeoutId = undefined;\n        lastInvokeTime = Date.now();\n        if (!isImmediate) {\n          const result = func.apply(context, args);\n          callback && callback(result);\n          promises.forEach(({ resolve }) => resolve(result));\n          promises = [];\n        }\n      };\n\n      const shouldCallNow = isImmediate && timeoutId === undefined;\n\n      if (timeoutId !== undefined) {\n        clearTimeout(timeoutId);\n      }\n\n      timeoutId = setTimeout(invokeFunction, nextInvokeTimeout());\n\n      if (shouldCallNow) {\n        const result = func.apply(context, args);\n        callback && callback(result);\n        return resolve(result);\n      }\n      promises.push({ resolve, reject });\n    });\n  };\n\n  debouncedFunction.cancel = function (reason?: any) {\n    if (timeoutId !== undefined) {\n      clearTimeout(timeoutId);\n    }\n    promises.forEach(({ reject }) => reject(reason));\n    promises = [];\n  };\n\n  return debouncedFunction;\n}\n","import { SearchResult } from '../types'\nimport { store } from './store'\nimport { getURLParts } from '../utils'\nimport * as historyStore from './history'\nimport { getSuggestionsDebounced } from '../api'\n\ninterface Option {\n  type: 'search' | 'history'\n  title: string\n  value: number\n  rawTitle: string\n  originalTitle: string\n}\n\nexport interface SuggestionsState {\n  isSuggestFocused: boolean\n  inputValue: string\n  lastInputValue: string\n  suggestions: SearchResult[]\n}\n\nexport const state = store<SuggestionsState>({\n  isSuggestFocused: false,\n  inputValue: getURLParts().searchParams.get('q') ?? '',\n  lastInputValue: '',\n  suggestions: []\n})\n\nexport const subscribe = state.subscribe\n\nexport const fetchSuggestions = async (): Promise<void> => {\n  if (state.lastInputValue === state.inputValue) {\n    return\n  }\n\n  state.lastInputValue = state.inputValue\n  getSuggestionsDebounced.cancel('abort')\n\n  if (state.inputValue.trim() === '') {\n    state.suggestions = []\n    return\n  }\n\n  try {\n    const { results } = await getSuggestionsDebounced(state.inputValue)\n    state.suggestions = results\n  } catch (e) {\n    if (e !== 'abort') {\n      throw e\n    }\n  }\n}\n\nconst purifySearchString = (str: string): string => (\n  str.toLowerCase().replaceAll(/[^a-zа-яё]/g, '')\n)\n\nexport const getVisibleOptions = (): Option[] => {\n  const inputValuePrepared = purifySearchString(state.inputValue)\n  const itemsFromHistory: Option[] = historyStore.state.items\n    .filter((item) => (\n      purifySearchString(item.title).includes(inputValuePrepared) ||\n      purifySearchString(item.originalTitle).includes(inputValuePrepared)\n    ))\n    .slice(0, 5)\n    .map((item) => ({\n      type: 'history',\n      title: `${item.title}${item.originalTitle !== '' ? ` (${item.originalTitle})` : ''}`,\n      value: item.id,\n      rawTitle: item.title,\n      originalTitle: item.originalTitle\n    }))\n\n  const historyIds = itemsFromHistory.map((item) => item.value)\n\n  const itemsFromSuggestions: Option[] = state.suggestions\n    .filter((suggestion) => !historyIds.includes(suggestion.id))\n    .slice(0, 10 - itemsFromHistory.length)\n    .map((suggestion) => {\n      const parenthesisBits: string[] = []\n\n      if (suggestion.original_title !== '' && suggestion.original_title !== suggestion.title) {\n        parenthesisBits.push(suggestion.original_title)\n      }\n\n      if (suggestion.release_date !== '' && typeof suggestion.release_date.split('-')[0] !== 'undefined') {\n        parenthesisBits.push(suggestion.release_date.split('-')[0])\n      }\n\n      return ({\n        type: 'search',\n        title: `${suggestion.title}${parenthesisBits.length > 0 ? ` (${parenthesisBits.join(', ')})` : ''}`,\n        value: suggestion.id,\n        rawTitle: suggestion.title,\n        originalTitle: suggestion.original_title\n      })\n    })\n\n  return [...itemsFromHistory, ...itemsFromSuggestions]\n}\n","import type { Genre } from '../types'\nimport { store } from './store'\nimport { getMovie } from '../api'\n\nexport interface DetailItem {\n  genres: Genre[]\n  id: number\n  imdbId: string\n  originalTitle: string\n  title: string\n  overview: string\n  tagline: string\n  posterPath: string\n  year: string\n}\n\nexport interface DetailState {\n  item: DetailItem | null\n}\n\nexport const state = store<DetailState>({\n  item: null\n})\n\nexport const subscribe = state.subscribe\n\nexport const fetchItem = async (id: number): Promise<void> => {\n  try {\n    const movieResponse = await getMovie(id)\n\n    if ('success' in movieResponse && !movieResponse.success) {\n      state.item = null\n\n      return\n    }\n\n    if (!('id' in movieResponse)) {\n      return\n    }\n\n    state.item = {\n      genres: movieResponse.genres,\n      id: movieResponse.id,\n      imdbId: movieResponse.imdb_id,\n      tagline: movieResponse.tagline,\n      originalTitle: movieResponse.original_title,\n      overview: movieResponse.overview,\n      title: movieResponse.title,\n      posterPath: movieResponse.poster_path,\n      year: movieResponse.release_date.split('-')[0]\n    }\n  } catch (error: any) {\n    state.item = null\n    console.error('Произошла ошибка при запросе данных')\n  }\n}\n\nexport const clearItem = (): void => {\n  state.item = null\n}\n","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"hEwHo\")).toString();","import * as detailStore from '../../store/detail'\nimport { getURLParts } from '../../utils'\n\nconst imdbSvg = new URL('imdb.svg', import.meta.url)\nconst noImageSvg = new URL('no-image.svg', import.meta.url)\n\nexport const init = (): void => {\n  const detailElement = document.querySelector<HTMLDivElement>('.js-detail')\n  if (detailElement === null) {\n    return\n  }\n\n  const render = (): void => {\n    const {\n      item\n    } = detailStore.state\n\n    if (item === null) {\n      detailElement.innerHTML = ''\n\n      return\n    }\n\n    const {\n      genres,\n      imdbId,\n      title,\n      overview,\n      tagline,\n      posterPath,\n      year\n    } = item\n\n    detailElement.innerHTML = `\n      ${posterPath !== ''\n        ? (`\n          <a class=\"hidden md:block\" href=\"https://image.tmdb.org/t/p/original${posterPath}\" target=\"_blank\" rel=\"nofollow noopener\">\n            <img \n              class=\"rounded\" src=\"https://image.tmdb.org/t/p/w300${posterPath}\" \n              alt=\"постер к фильму ${title}\" \n              onerror=\"this.src = '${noImageSvg.toString()}'\"\n            />\n          </a>\n        `)\n        : ''\n      }\n      \n      <div class=\"prose prose-slate\">\n        <h1 class=\"mb-0\">${title}${year !== '' ? ` (${year})` : ''}</h1>\n      \n        ${tagline !== '' ? `<blockquote class=\"my-2\">${tagline}</blockquote>` : ''}\n      \n        ${overview !== '' ? `<p>${overview}</p>` : ''}\n      \n        ${genres.length > 0\n          ? (`\n            <div class=\"my-4 flex flex-wrap gap-2\">\n              Жанры:\n              ${genres.map(({ name }) => (`\n                <div class=\"rounded border border-slate-300 bg-slate-200 px-2\">${name}</div>\n              `)).join('')}\n            </div>\n          `)\n          : ''\n        }\n        \n        ${imdbId !== ''\n          ? (`\n            <div class=\"my-4 flex flex-wrap gap-2 not-prose\">\n              <a href=\"https://www.imdb.com/title/${imdbId}/\" target=\"_blank\" rel=\"noopener nofollow\">\n                <img src=\"${imdbSvg.toString()}\" alt=\"\">\n              </a>\n            </div>\n          `)\n          : ''\n        }\n      </div>\n    `\n  }\n\n  const parseHashAndFetchItem = async (): Promise<void> => {\n    const { path } = getURLParts()\n\n    const match = path.match(/^\\/movie\\/(\\d+)/)\n    if (match === null || match.length <= 1) {\n      detailStore.clearItem()\n\n      return\n    }\n\n    const movieId = parseInt(match[1], 10)\n    if (Number.isNaN(movieId)) {\n      detailStore.clearItem()\n\n      return\n    }\n\n    await detailStore.fetchItem(movieId)\n  }\n\n  window.addEventListener('hashchange', parseHashAndFetchItem)\n\n  void parseHashAndFetchItem()\n  detailStore.subscribe(render)\n  render()\n}\n","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"gGD6r\")).toString();","import * as suggestionsStore from '../../store/suggestions'\nimport * as historyStore from '../../store/history'\nimport { getURLParts } from '../../utils'\n\nexport const init = (): void => {\n  const historyElement = document.querySelector<HTMLDivElement>('.js-history')\n  const historyList = document.querySelector<HTMLUListElement>('.js-history-list')\n\n  if (historyElement === null || historyList === null) {\n    return\n  }\n\n  const render = (): void => {\n    const { search } = getURLParts()\n\n    historyElement.style.display = historyStore.state.items.length === 0 ? 'none' : ''\n\n    historyList.innerHTML = historyStore.state.items\n      .slice(0, 3)\n      .map(({ title, id }) => (`\n        <li>\n          <a\n            class=\"block outline-none text-emerald-600 hover:text-emerald-500 focus-visible:text-emerald-500\"\n            href=\"#/movie/${id}${search !== '' ? `?${search}` : ''}\"\n          >${title}</a>\n        </li>\n      `))\n      .join('')\n  }\n\n  window.addEventListener('storage', historyStore.updateFromStorage)\n\n  historyStore.updateFromStorage()\n  suggestionsStore.subscribe(render)\n  historyStore.subscribe(render)\n  render()\n}\n","import * as History from './blocks/history'\nimport * as Suggestions from './blocks/suggestions'\nimport * as Detail from './blocks/detail'\n\nHistory.init()\nSuggestions.init()\nDetail.init()\n","import { getURLParts, setURLParts } from '../../utils'\nimport * as historyStore from '../../store/history'\nimport * as suggestionsStore from '../../store/suggestions'\n\nexport const init = (): void => {\n  const formElement = document.querySelector<HTMLFormElement>('.js-suggest-form')\n  const clearElement = document.querySelector<HTMLButtonElement>('.js-suggest-clear')\n  const inputElement = document.querySelector<HTMLInputElement>('.js-suggest-input')\n  const suggestionsElement = document.querySelector<HTMLUListElement>('.js-suggest-options')\n\n  if (formElement === null || clearElement === null || inputElement === null || suggestionsElement === null) {\n    return\n  }\n\n  const render = (): void => {\n    const {\n      isSuggestFocused,\n      inputValue,\n      suggestions\n    } = suggestionsStore.state\n\n    const { search } = getURLParts()\n\n    inputElement.value = inputValue\n\n    suggestionsElement.style.display = isSuggestFocused && suggestions.length !== 0 ? '' : 'none'\n    suggestionsElement.innerHTML = suggestionsStore.getVisibleOptions()\n      .map((suggestion) => (`\n        <li>\n          <a \n            class=\"block px-3 py-1 focus-visible:bg-slate-100 hover:bg-slate-100${suggestion.type === 'history' ? ' text-purple-800' : ''}\"\n            href=\"#/movie/${suggestion.value}${search !== '' ? `?${search}` : ''}\"\n          >${suggestion.title}</a>\n        </li>\n      `))\n      .join('')\n  }\n\n  formElement.addEventListener('submit', (e) => {\n    e.preventDefault()\n  })\n\n  clearElement.addEventListener('click', () => {\n    suggestionsStore.state.inputValue = ''\n    suggestionsStore.state.suggestions = []\n    suggestionsStore.state.isSuggestFocused = false\n    setURLParts({ search: '' })\n  })\n\n  inputElement.addEventListener('input', async ({ currentTarget }) => {\n    if (!(currentTarget instanceof HTMLInputElement)) {\n      return\n    }\n\n    suggestionsStore.state.inputValue = currentTarget.value\n    setURLParts({\n      search: currentTarget.value.trim() !== '' ? `q=${currentTarget.value}` : ''\n    })\n\n    await suggestionsStore.fetchSuggestions()\n  })\n\n  inputElement.addEventListener('click', suggestionsStore.fetchSuggestions)\n\n  formElement.addEventListener('keydown', (e) => {\n    const index = Array.prototype.indexOf.call(suggestionsElement.children, document.activeElement?.closest('li'))\n    let newIndex = index\n\n    if (e.key === 'ArrowUp') {\n      newIndex = Math.max(0, newIndex - 1)\n    } else if (e.key === 'ArrowDown') {\n      newIndex = Math.min(suggestionsElement.children.length - 1, newIndex + 1)\n    } else if (e.key === 'Escape') {\n      suggestionsStore.state.isSuggestFocused = false\n    }\n\n    if (index !== newIndex && ['ArrowUp', 'ArrowDown'].includes(e.key)) {\n      suggestionsElement.children[newIndex]?.querySelector('a')?.focus()\n    }\n  })\n\n  inputElement.addEventListener('focus', () => {\n    suggestionsStore.state.isSuggestFocused = true\n  })\n\n  document.addEventListener('click', (e) => {\n    if (!suggestionsStore.state.isSuggestFocused) {\n      return\n    }\n\n    const newState = e.target instanceof Node && formElement.contains(e.target)\n    if (suggestionsStore.state.isSuggestFocused !== newState) {\n      e.preventDefault()\n      e.stopPropagation()\n      e.stopImmediatePropagation()\n\n      suggestionsStore.state.isSuggestFocused = newState\n    }\n  })\n\n  suggestionsElement.addEventListener('click', (e) => {\n    if (!(e.target instanceof Element)) {\n      return\n    }\n\n    const liElement = e.target.closest('li')\n    if (liElement === null) {\n      return\n    }\n\n    const clickedIndex = Array.prototype.indexOf.call(suggestionsElement.children, liElement)\n    const options = suggestionsStore.getVisibleOptions()\n\n    if (typeof options[clickedIndex] !== 'undefined') {\n      const { rawTitle, value, originalTitle } = options[clickedIndex]\n\n      historyStore.append({\n        title: rawTitle,\n        id: value,\n        originalTitle\n      })\n    }\n\n    suggestionsStore.state.isSuggestFocused = false\n  })\n\n  historyStore.subscribe(render)\n  suggestionsStore.subscribe(render)\n  render()\n}\n"],"names":["$16bf769740af8836$export$6503ec6e8aabbaf","$16bf769740af8836$export$f7ad0328861e2f03","$16bf769740af8836$var$mapping","pairs","keys","Object","i","length","id","resolved","Error","parcelRequire","register","JSON","parse","$0996f733f49c018d$export$6f57813fe9f31bf9","data","subscribers","subscribe","subscriber","push","emit","forEach","handler","dataObj","get","obj","prop","includes","prototype","toString","call","slice","toLowerCase","_isProxy","Reflect","set","Proxy","value","deleteProperty","$649d35a98c5c5ad4$var$PATH_REGEXP","$649d35a98c5c5ad4$export$580e4212c2f62d89","match","window","location","hash","groups","path","search","searchParams","URLSearchParams","e","$2974d24439982eb0$export$5f9b7b2110300981","parts","currentURLParts","$315348d126bedbbc$export$ca000e230c0caa3e","items","$315348d126bedbbc$export$ec068583843480e7","$315348d126bedbbc$export$ff9cb03fdfe7e63f","$315348d126bedbbc$var$getFromStorage","$315348d126bedbbc$var$STORAGE_KEY","newItemsRaw","localStorage","getItem","newItems","Array","isArray","$315348d126bedbbc$var$updateStorage","setItem","stringify","$84733edfb8800392$export$69b671f721443b81","$84733edfb8800392$export$699251e5611cc6db","async","url","urlObject","URL","fetch","then","response","ok","json","$b94436b97830a5a9$export$3f2115efb70b687f","debounce","func","waitMilliseconds","options","timeoutId","isImmediate","callback","maxWait","lastInvokeTime","Date","now","promises","nextInvokeTimeout","timeSinceLastInvocation","debouncedFunction","args","context","this","Promise","resolve","reject","shouldCallNow","clearTimeout","setTimeout","result","apply","r","cancel","reason","query","$b94436b97830a5a9$export$bdba5afeee6501b","$64dbbf55feed9c79$export$ca000e230c0caa3e","isSuggestFocused","inputValue","lastInputValue","suggestions","$64dbbf55feed9c79$export$ec068583843480e7","$64dbbf55feed9c79$export$ebf2f44fe450da2b","trim","results","$64dbbf55feed9c79$var$purifySearchString","str","replaceAll","$64dbbf55feed9c79$export$269945a0be0df3e5","inputValuePrepared","itemsFromHistory","filter","item","title","originalTitle","map","type","rawTitle","historyIds","itemsFromSuggestions","suggestion","parenthesisBits","original_title","release_date","split","join","$61ce2f5dd629e27a$export$ca000e230c0caa3e","$61ce2f5dd629e27a$export$ec068583843480e7","$61ce2f5dd629e27a$export$78af959256a39335","movieResponse","success","genres","imdbId","imdb_id","tagline","overview","posterPath","poster_path","year","error","console","$61ce2f5dd629e27a$export$c4418ad9fa7bfb0c","$10b5c696b8db1e7b$exports","import","meta","$e10e8775706531f1$var$imdbSvg","$6f504fe5bad45bf4$exports","$e10e8775706531f1$var$noImageSvg","historyElement","document","querySelector","historyList","render","style","display","innerHTML","addEventListener","$8bf476b41363c0a6$export$2cd8252107eb640b","formElement","clearElement","inputElement","suggestionsElement","preventDefault","currentTarget","HTMLInputElement","index","indexOf","children","activeElement","closest","newIndex","key","Math","max","min","focus","newState","target","Node","contains","stopPropagation","stopImmediatePropagation","Element","liElement","clickedIndex","indexOfSimilar","findIndex","lookupItem","splice","unshift","$315348d126bedbbc$export$10d8903dec122b9d","$fe7089014d17f8fa$export$2cd8252107eb640b","detailElement","name","parseHashAndFetchItem","movieId","parseInt","Number","isNaN","$e10e8775706531f1$export$2cd8252107eb640b"],"version":3,"file":"index.01cc66cb.js.map"}